<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JELILIAN æœ€ç»ˆæµ‹è¯•</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; }
        .test-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0; }
        .test-card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .test-card h3 { margin: 0 0 15px 0; color: #333; }
        .status { padding: 8px 12px; border-radius: 6px; font-weight: 600; margin: 10px 0; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .loading { background: #fff3cd; color: #856404; }
        .pending { background: #e2e3e5; color: #383d41; }
        button { background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; margin: 5px; }
        button:hover { background: #0056b3; }
        .result { margin: 10px 0; padding: 10px; background: #f8f9fa; border-radius: 6px; font-size: 14px; }
        .header { text-align: center; margin-bottom: 30px; }
        .header h1 { color: #333; margin-bottom: 10px; }
        .header p { color: #666; }
        .summary { background: white; padding: 20px; border-radius: 12px; margin: 20px 0; }
        .progress-bar { width: 100%; height: 20px; background: #e9ecef; border-radius: 10px; overflow: hidden; margin: 10px 0; }
        .progress-fill { height: 100%; background: #28a745; transition: width 0.3s; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ JELILIAN AI æœ€ç»ˆæµ‹è¯•</h1>
            <p>å…¨é¢æµ‹è¯•æ‰€æœ‰åŠŸèƒ½ï¼Œç¡®ä¿éƒ¨ç½²å°±ç»ª</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar" style="width: 0%"></div>
            </div>
            <div id="overallStatus" class="status pending">å‡†å¤‡å¼€å§‹æµ‹è¯•...</div>
        </div>

        <div class="test-grid">
            <!-- æœåŠ¡å™¨è¿æ¥æµ‹è¯• -->
            <div class="test-card">
                <h3>ğŸ”— æœåŠ¡å™¨è¿æ¥</h3>
                <div id="serverStatus" class="status pending">ç­‰å¾…æµ‹è¯•</div>
                <button onclick="testServer()">æµ‹è¯•è¿æ¥</button>
                <div id="serverResult" class="result"></div>
            </div>

            <!-- APIæœåŠ¡å•†æµ‹è¯• -->
            <div class="test-card">
                <h3>ğŸ¤– AIæœåŠ¡å•†</h3>
                <div id="providersStatus" class="status pending">ç­‰å¾…æµ‹è¯•</div>
                <button onclick="testProviders()">æµ‹è¯•æœåŠ¡å•†</button>
                <div id="providersResult" class="result"></div>
            </div>

            <!-- ç•Œé¢åŠŸèƒ½æµ‹è¯• -->
            <div class="test-card">
                <h3>ğŸ¨ ç•Œé¢åŠŸèƒ½</h3>
                <div id="interfaceStatus" class="status pending">ç­‰å¾…æµ‹è¯•</div>
                <button onclick="testInterface()">æµ‹è¯•ç•Œé¢</button>
                <div id="interfaceResult" class="result"></div>
            </div>

            <!-- Manusé£æ ¼æµ‹è¯• -->
            <div class="test-card">
                <h3>ğŸ¯ Manusé£æ ¼</h3>
                <div id="manusStatus" class="status pending">ç­‰å¾…æµ‹è¯•</div>
                <button onclick="testManusStyle()">æµ‹è¯•é£æ ¼</button>
                <div id="manusResult" class="result"></div>
            </div>

            <!-- éƒ¨ç½²é…ç½®æµ‹è¯• -->
            <div class="test-card">
                <h3>ğŸŒ éƒ¨ç½²é…ç½®</h3>
                <div id="deployStatus" class="status pending">ç­‰å¾…æµ‹è¯•</div>
                <button onclick="testDeployment()">æµ‹è¯•éƒ¨ç½²</button>
                <div id="deployResult" class="result"></div>
            </div>

            <!-- æ€§èƒ½æµ‹è¯• -->
            <div class="test-card">
                <h3>âš¡ æ€§èƒ½æµ‹è¯•</h3>
                <div id="performanceStatus" class="status pending">ç­‰å¾…æµ‹è¯•</div>
                <button onclick="testPerformance()">æµ‹è¯•æ€§èƒ½</button>
                <div id="performanceResult" class="result"></div>
            </div>
        </div>

        <div class="summary">
            <h3>ğŸ“Š æµ‹è¯•æ€»ç»“</h3>
            <div id="testSummary">ç‚¹å‡»"å¼€å§‹å…¨é¢æµ‹è¯•"æŒ‰é’®å¼€å§‹æµ‹è¯•æ‰€æœ‰åŠŸèƒ½</div>
            <button onclick="runAllTests()" style="background: #28a745; font-size: 16px; padding: 15px 30px;">ğŸš€ å¼€å§‹å…¨é¢æµ‹è¯•</button>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:3000/api';
        let testResults = {};
        let testsCompleted = 0;
        const totalTests = 6;

        function updateProgress() {
            const progress = (testsCompleted / totalTests) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            
            if (testsCompleted === totalTests) {
                const allPassed = Object.values(testResults).every(result => result.success);
                const overallStatus = document.getElementById('overallStatus');
                if (allPassed) {
                    overallStatus.textContent = 'âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ç³»ç»Ÿå°±ç»ª';
                    overallStatus.className = 'status success';
                } else {
                    overallStatus.textContent = 'âŒ éƒ¨åˆ†æµ‹è¯•å¤±è´¥ï¼Œéœ€è¦ä¿®å¤';
                    overallStatus.className = 'status error';
                }
                updateSummary();
            }
        }

        function updateSummary() {
            const summary = document.getElementById('testSummary');
            const results = Object.entries(testResults);
            const passed = results.filter(([_, result]) => result.success).length;
            const failed = results.filter(([_, result]) => !result.success).length;
            
            summary.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 15px 0;">
                    <div style="text-align: center;">
                        <div style="font-size: 24px; color: #28a745;">âœ… ${passed}</div>
                        <div>æµ‹è¯•é€šè¿‡</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 24px; color: #dc3545;">âŒ ${failed}</div>
                        <div>æµ‹è¯•å¤±è´¥</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 24px; color: #007bff;">ğŸ“Š ${Math.round((passed/totalTests)*100)}%</div>
                        <div>é€šè¿‡ç‡</div>
                    </div>
                </div>
                <div style="margin-top: 20px;">
                    ${results.map(([test, result]) => 
                        `<div style="margin: 5px 0;">${result.success ? 'âœ…' : 'âŒ'} ${test}: ${result.message}</div>`
                    ).join('')}
                </div>
            `;
        }

        async function testServer() {
            const statusEl = document.getElementById('serverStatus');
            const resultEl = document.getElementById('serverResult');
            
            statusEl.textContent = 'æµ‹è¯•ä¸­...';
            statusEl.className = 'status loading';
            
            try {
                const response = await fetch(API_BASE + '/providers');
                if (response.ok) {
                    statusEl.textContent = 'âœ… è¿æ¥æˆåŠŸ';
                    statusEl.className = 'status success';
                    resultEl.innerHTML = 'æœåŠ¡å™¨å“åº”æ­£å¸¸ï¼ŒAPIç«¯ç‚¹å¯è®¿é—®';
                    testResults.server = { success: true, message: 'æœåŠ¡å™¨è¿æ¥æ­£å¸¸' };
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                statusEl.textContent = 'âŒ è¿æ¥å¤±è´¥';
                statusEl.className = 'status error';
                resultEl.innerHTML = 'é”™è¯¯: ' + error.message;
                testResults.server = { success: false, message: 'æœåŠ¡å™¨è¿æ¥å¤±è´¥' };
            }
            testsCompleted++;
            updateProgress();
        }

        async function testProviders() {
            const statusEl = document.getElementById('providersStatus');
            const resultEl = document.getElementById('providersResult');
            
            statusEl.textContent = 'æµ‹è¯•ä¸­...';
            statusEl.className = 'status loading';
            
            try {
                const response = await fetch(API_BASE + '/providers');
                const data = await response.json();
                
                if (data.success && data.providers.length > 0) {
                    statusEl.textContent = 'âœ… æœåŠ¡å•†æ­£å¸¸';
                    statusEl.className = 'status success';
                    resultEl.innerHTML = `æ”¯æŒ ${data.providers.length} ä¸ªAIæœåŠ¡å•†: ${data.providers.map(p => p.name).join(', ')}`;
                    testResults.providers = { success: true, message: `æ”¯æŒ${data.providers.length}ä¸ªAIæœåŠ¡å•†` };
                } else {
                    throw new Error('æ— å¯ç”¨æœåŠ¡å•†');
                }
            } catch (error) {
                statusEl.textContent = 'âŒ æœåŠ¡å•†å¼‚å¸¸';
                statusEl.className = 'status error';
                resultEl.innerHTML = 'é”™è¯¯: ' + error.message;
                testResults.providers = { success: false, message: 'AIæœåŠ¡å•†é…ç½®å¼‚å¸¸' };
            }
            testsCompleted++;
            updateProgress();
        }

        async function testInterface() {
            const statusEl = document.getElementById('interfaceStatus');
            const resultEl = document.getElementById('interfaceResult');
            
            statusEl.textContent = 'æµ‹è¯•ä¸­...';
            statusEl.className = 'status loading';
            
            try {
                const tests = [
                    { name: 'ä¸»é¡µé¢', url: 'http://localhost:3000/' },
                    { name: 'å…¬å…±å®¢æˆ·ç«¯', url: 'http://localhost:3000/public-client.html' },
                    { name: 'æµ‹è¯•å·¥å…·', url: 'http://localhost:3000/test-functionality.html' }
                ];
                
                const results = await Promise.all(tests.map(async test => {
                    try {
                        const response = await fetch(test.url);
                        return { name: test.name, success: response.ok };
                    } catch {
                        return { name: test.name, success: false };
                    }
                }));
                
                const allSuccess = results.every(r => r.success);
                if (allSuccess) {
                    statusEl.textContent = 'âœ… ç•Œé¢æ­£å¸¸';
                    statusEl.className = 'status success';
                    resultEl.innerHTML = 'æ‰€æœ‰ç•Œé¢é¡µé¢åŠ è½½æ­£å¸¸';
                    testResults.interface = { success: true, message: 'ç•Œé¢åŠŸèƒ½æ­£å¸¸' };
                } else {
                    throw new Error('éƒ¨åˆ†ç•Œé¢æ— æ³•è®¿é—®');
                }
            } catch (error) {
                statusEl.textContent = 'âŒ ç•Œé¢å¼‚å¸¸';
                statusEl.className = 'status error';
                resultEl.innerHTML = 'é”™è¯¯: ' + error.message;
                testResults.interface = { success: false, message: 'ç•Œé¢åŠŸèƒ½å¼‚å¸¸' };
            }
            testsCompleted++;
            updateProgress();
        }

        async function testManusStyle() {
            const statusEl = document.getElementById('manusStatus');
            const resultEl = document.getElementById('manusResult');
            
            statusEl.textContent = 'æµ‹è¯•ä¸­...';
            statusEl.className = 'status loading';
            
            try {
                const response = await fetch('http://localhost:3000/manus-clone.html');
                if (response.ok) {
                    const html = await response.text();
                    
                    // æ£€æŸ¥å…³é”®å…ƒç´ 
                    const checks = [
                        { name: 'æ ‡é¢˜', test: html.includes('æˆ‘èƒ½ä¸ºä½ åšä»€ä¹ˆï¼Ÿ') },
                        { name: 'åŠŸèƒ½æ ‡ç­¾', test: html.includes('åˆ¶ä½œå¹»ç¯ç‰‡') && html.includes('åˆ›å»ºç½‘ç«™') },
                        { name: 'è¾“å…¥æ¡†', test: html.includes('åˆ†äº«ä¸€ä¸ªä»»åŠ¡æˆ–è¯¢é—®ä½ çš„é—®é¢˜') },
                        { name: 'JELILIANå“ç‰Œ', test: html.includes('JELILIAN') && !html.includes('Manus') }
                    ];
                    
                    const allPassed = checks.every(check => check.test);
                    if (allPassed) {
                        statusEl.textContent = 'âœ… é£æ ¼åŒ¹é…';
                        statusEl.className = 'status success';
                        resultEl.innerHTML = 'Manusé£æ ¼å®Œç¾å¤åˆ¶ï¼ŒJELILIANå“ç‰Œç‹¬ç«‹';
                        testResults.manus = { success: true, message: 'Manusé£æ ¼å®Œç¾åŒ¹é…' };
                    } else {
                        throw new Error('é£æ ¼ä¸åŒ¹é…');
                    }
                } else {
                    throw new Error('é¡µé¢æ— æ³•è®¿é—®');
                }
            } catch (error) {
                statusEl.textContent = 'âŒ é£æ ¼å¼‚å¸¸';
                statusEl.className = 'status error';
                resultEl.innerHTML = 'é”™è¯¯: ' + error.message;
                testResults.manus = { success: false, message: 'Manusé£æ ¼ä¸åŒ¹é…' };
            }
            testsCompleted++;
            updateProgress();
        }

        async function testDeployment() {
            const statusEl = document.getElementById('deployStatus');
            const resultEl = document.getElementById('deployResult');
            
            statusEl.textContent = 'æµ‹è¯•ä¸­...';
            statusEl.className = 'status loading';
            
            try {
                // æ£€æŸ¥éƒ¨ç½²æ–‡ä»¶
                const files = ['vercel.json', 'package.json', 'server.js'];
                const checks = await Promise.all(files.map(async file => {
                    try {
                        const response = await fetch(`http://localhost:3000/${file}`);
                        return { file, exists: response.status !== 404 };
                    } catch {
                        return { file, exists: false };
                    }
                }));
                
                const configExists = checks.some(c => c.file === 'vercel.json' && c.exists);
                if (configExists) {
                    statusEl.textContent = 'âœ… é…ç½®å®Œæ•´';
                    statusEl.className = 'status success';
                    resultEl.innerHTML = 'éƒ¨ç½²é…ç½®æ–‡ä»¶å®Œæ•´ï¼ŒGitHubåŒæ­¥æ­£å¸¸';
                    testResults.deployment = { success: true, message: 'éƒ¨ç½²é…ç½®å®Œæ•´' };
                } else {
                    throw new Error('éƒ¨ç½²é…ç½®ç¼ºå¤±');
                }
            } catch (error) {
                statusEl.textContent = 'âŒ é…ç½®å¼‚å¸¸';
                statusEl.className = 'status error';
                resultEl.innerHTML = 'é”™è¯¯: ' + error.message;
                testResults.deployment = { success: false, message: 'éƒ¨ç½²é…ç½®å¼‚å¸¸' };
            }
            testsCompleted++;
            updateProgress();
        }

        async function testPerformance() {
            const statusEl = document.getElementById('performanceStatus');
            const resultEl = document.getElementById('performanceResult');
            
            statusEl.textContent = 'æµ‹è¯•ä¸­...';
            statusEl.className = 'status loading';
            
            try {
                const startTime = Date.now();
                const response = await fetch(API_BASE + '/providers');
                const endTime = Date.now();
                const responseTime = endTime - startTime;
                
                if (response.ok && responseTime < 1000) {
                    statusEl.textContent = 'âœ… æ€§èƒ½è‰¯å¥½';
                    statusEl.className = 'status success';
                    resultEl.innerHTML = `APIå“åº”æ—¶é—´: ${responseTime}ms (ä¼˜ç§€)`;
                    testResults.performance = { success: true, message: `å“åº”æ—¶é—´${responseTime}ms` };
                } else if (responseTime >= 1000) {
                    statusEl.textContent = 'âš ï¸ æ€§èƒ½ä¸€èˆ¬';
                    statusEl.className = 'status loading';
                    resultEl.innerHTML = `APIå“åº”æ—¶é—´: ${responseTime}ms (å¯æ¥å—)`;
                    testResults.performance = { success: true, message: `å“åº”æ—¶é—´${responseTime}ms` };
                } else {
                    throw new Error('æ€§èƒ½æµ‹è¯•å¤±è´¥');
                }
            } catch (error) {
                statusEl.textContent = 'âŒ æ€§èƒ½å¼‚å¸¸';
                statusEl.className = 'status error';
                resultEl.innerHTML = 'é”™è¯¯: ' + error.message;
                testResults.performance = { success: false, message: 'æ€§èƒ½æµ‹è¯•å¤±è´¥' };
            }
            testsCompleted++;
            updateProgress();
        }

        async function runAllTests() {
            testResults = {};
            testsCompleted = 0;
            
            // é‡ç½®æ‰€æœ‰çŠ¶æ€
            document.querySelectorAll('.status').forEach(el => {
                if (el.id !== 'overallStatus') {
                    el.textContent = 'ç­‰å¾…æµ‹è¯•';
                    el.className = 'status pending';
                }
            });
            
            document.getElementById('overallStatus').textContent = 'æµ‹è¯•è¿›è¡Œä¸­...';
            document.getElementById('overallStatus').className = 'status loading';
            
            // ä¾æ¬¡æ‰§è¡Œæ‰€æœ‰æµ‹è¯•
            await testServer();
            await new Promise(resolve => setTimeout(resolve, 500));
            await testProviders();
            await new Promise(resolve => setTimeout(resolve, 500));
            await testInterface();
            await new Promise(resolve => setTimeout(resolve, 500));
            await testManusStyle();
            await new Promise(resolve => setTimeout(resolve, 500));
            await testDeployment();
            await new Promise(resolve => setTimeout(resolve, 500));
            await testPerformance();
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨å¼€å§‹æµ‹è¯•
        window.onload = function() {
            setTimeout(runAllTests, 1000);
        };
    </script>
</body>
</html>